<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>SmartBuy</title>
    <meta name="keywords" content="HTML5 Template" />
    <meta name="description" content="Molla - Bootstrap eCommerce Template" />
    <meta name="author" content="p-themes" />
    <!-- Favicon -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="assets/images/icons/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="assets/images/icons/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="assets/images/icons/favicon-16x16.png"
    />
    <link rel="manifest" href="assets/images/icons/site.html" />
    <link
      rel="mask-icon"
      href="assets/images/icons/safari-pinned-tab.svg"
      color="#666666"
    />
    <link rel="shortcut icon" href="assets/images/icons/favicon.ico" />
    <meta name="apple-mobile-web-app-title" content="Molla" />
    <meta name="application-name" content="Molla" />
    <meta name="msapplication-TileColor" content="#cc9966" />
    <meta
      name="msapplication-config"
      content="assets/images/icons/browserconfig.xml"
    />
    <meta name="theme-color" content="#ffffff" />

    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="assets/css/plugins/owl-carousel/owl.carousel.css"
    />
    <link rel="stylesheet" href="assets/css/plugins/jquery.countdown.css" />
    <link
      rel="stylesheet"
      href="assets/css/plugins/magnific-popup/magnific-popup.css"
    />
    <!-- Main CSS File -->
    <link rel="stylesheet" href="assets/css/style2.css" />
    <link rel="stylesheet" href="assets/css/skins/skin-demo-24.css" />
    <link rel="stylesheet" href="assets/css/demos/demo-24.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Plugins CSS File -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <!-- Main CSS File -->
    <link rel="stylesheet" href="assets/css/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
    <header class="header" style="background-color: #000000">
      <div class="header-middle sticky-header">
        <!-- <a href="index.html"  style="font-size: 11px;font-weight: 200;color: white;">
  Powered By
</a> -->
        <div class="header-left">
          <button class="mobile-menu-toggler">
            <span class="sr-only">Toggle mobile menu</span>
            <i class="icon-bars"></i>
          </button>

          <a
            href="index.html"
            style="font-size: 30px; font-weight: 500; color: white"
            >SmartBuy</a
          >
        </div>
        <!-- End .header-left -->

        <div style="margin-left: 0%" class="header-center">
          <nav class="main-nav">
            <ul class="menu sf-arrows">
              <li class="megamenu-container active">
                <a href="/" class="sf-with-ul">Home</a>
              </li>
              <li>
                <a href="/Allproducts" class="sf-with-ul">Shop</a>
              </li>
              <li>
                <a href="/" class="sf-with-ul">Product</a>
              </li>
              <li>
                <a href="/" class="sf-with-ul">Pages</a>
              </li>
              <li>
                <a href="/" class="sf-with-ul">Blog</a>
              </li>
            </ul>
            <!-- End .menu -->
          </nav>
          <!-- End .main-nav -->
        </div>

        <div class="header-right">
          <div class="header-search">
            <a href="#" class="search-toggle" role="button" title="Search"
              ><i class="icon-search"></i
            ></a>
            <form action="#" method="get">
              <div class="header-search-wrapper">
                <label for="q" class="sr-only">Search</label>
                <input
                  type="search"
                  class="form-control"
                  name="q"
                  id="q"
                  placeholder="Search in..."
                  required
                />
              </div>
              <!-- End .header-search-wrapper -->
            </form>
          </div>
          <!-- End .header-search -->
          <div class="wishlist">
            <a href="/wishlist" title="Wishlist">
              <i class="icon-heart-o"></i>
              <!-- <span class="wishlist-count">3</span> -->
            </a>
          </div>
          <!-- End .compare-dropdown -->

          <div class="dropdown cart-dropdown">
            <a
              href="#"
              class="dropdown-toggle"
              role="button"
              data-toggle="dropdown"
              aria-haspopup="true"
              aria-expanded="false"
              data-display="static"
            >
              <a href="/userCart"><i class="icon-shopping-cart"></i></a>
              <!-- <span class="cart-count">2</span> -->
            </a>

            <!-- End .dropdown-menu -->
          </div>
          <!-- End .cart-dropdown -->
        </div>
        <!-- End .header-right -->
      </div>
      <!-- End .header-middle -->
    </header>
    <div
      class="page-header text-center"
      style="
        background: #000000;
        display: flex;
        height: 100px;
        align-items: center;
      "
    >
      <div class="container">
        <h1 class="page-title" style="color: white">User Profile</h1>
      </div>
      <!-- End .container -->
    </div>
    <section>
      <div class="container py-1">
        <div
          class="row col-lg-12"
          style="
            margin-bottom: 20px;
            margin-left: 5px;
            margin-right: 5px;
            display: flex;
            justify-content: center;
          "
        >
          <button class="btn btn-dark col-lg-2">
            <a href="/userOrders" style="text-decoration: none; color: white"
              >ORDERS</a
            >
          </button>
          <button class="btn btn-dark col-lg-2">
            <a href="/coupons" style="text-decoration: none; color: white"
              >COUPONS</a
            >
          </button>
          <button class="btn btn-dark col-lg-2">
            <a href="/wishlist" style="text-decoration: none; color: white"
              >WISHLIST</a
            >
          </button>
          <button class="btn btn-dark col-lg-2"><a href="/loadWallet" style="text-decoration: none;color: white;">WALLET</a></button>
        </div>

        <div class="row">
          <div class="container mt-2 d-flex justify-content-center">
            <div class="card p-3 col-lg-12" style="background-color: #ffff;border:solid 2px #000000;">
              <div class="d-flex align-items-center">
                <div class="image">
                  <img
                    src="/userImages/<%=userData.image%>"
                    class="rounded"
                    width="300"
                    
                  />
                </div>

                <div class="ml-3 w-100">
                  <h4  class="mb-0 mt-0"><%=userData.name%></h4>
                  <span style="font-weight: 400;" ><%=userData.email%></span>
                  <div><h6>Referral ID : <%=userData.toReffer%></h6></div>

                  <div
                    class="p-4 mt-2 bg-dark d-flex justify-content-between rounded text-white stats"
                  >
                    <div class="d-flex flex-column">
                      <span class="articles">Products Purchased</span>
                      <span class="number1">59</span>
                    </div>

                    <div class="d-flex flex-column">
                      <span class="followers">Reviews</span>
                      <span class="number2">47</span>
                    </div>

                    <div class="d-flex flex-column">
                      <span class="rating">Review Ratings</span>
                      <span class="number3">4.6</span>
                    </div>
                  </div>

                  <div class="button mt-2 d-flex flex-row align-items-center">
                    <button class="btn btn-sm btn-dark w-100 ml-2"><a href="/loadUserEdit?id=<%=userData._id%>" style="text-decoration: none;color: white;">Edit Profile</a></button>

                    
                      <button class="btn btn-sm btn-dark w-100 ml-2"><a href="/addShipAddr?id=<%=userData._id%>" style="text-decoration: none;color: white;">Add New Address</a></button>

                  </div>
                </div>
              </div>
            </div>
          </div>
         
        <h4 style="display: flex;justify-content: center;width: 100%;padding-top: 20px;">Primary Address</h4>
          <div class="col-lg-12">
            <div class="card mb-4" style="background-color: #000000;">
              <div class="card-body">
                <div class="row">
                  <div class="col-sm-3">
                    <p style="color: #ffff;" class="mb-0">Full Name</p>
                  </div>
                  <div class="col-sm-9">
                    <p style="color: #ffff;" class=" mb-0"><%=userData.name%></p>
                  </div>
                </div>
                <hr />
                <div class="row">
                  <div class="col-sm-3">
                    <p style="color: #ffff;" class="mb-0">Email</p>
                  </div>
                  <div class="col-sm-9">
                    <p style="color: #ffff;" class=" mb-0"><%=userData.email%></p>
                  </div>
                </div>
                <hr />
                <div class="row">
                  <div class="col-sm-3">
                    <p style="color: #ffff;" class="mb-0">Phone</p>
                  </div>
                  <div class="col-sm-9">
                    <p style="color: #ffff;" class=" mb-0"><%=userData.mobile%></p>
                  </div>
                </div>
                <hr />
                <div class="row">
                  <div class="col-sm-3">
                    <p style="color: #ffff;" class="mb-0">Address</p>
                  </div>
                  <div class="col-sm-9">
                    <p style="color: #ffff;" class=" mb-0"><%=userData.address%></p>
                  </div>
                </div>
                <hr />
                <div class="row">
                  <div class="col-sm-3">
                    <p style="color: #ffff;" class="mb-0">Pincode</p>
                  </div>
                  <div class="col-sm-9">
                    <p style="color: #ffff;" class=" mb-0"><%=userData.pincode%></p>
                  </div>
                </div>
              </div>
            </div>
          </div>


          
          <% if(!addrs || addrs.length === 0) { %>
            
          <% } else { %>
            <h4 style="display: flex;justify-content: center;width: 100%;">Shipping Address</h4>
          <% for(let i=0;i<addrs.length;i++) {%>
          <div class="col-lg-3">
            <div class="card mb-4" style="background-color: #000000;">
              <div class="card-body">
                <div class="row">
                  <div class="col-lg-12">
                    <div>
                      <div style="display: flex;justify-content: end;">
                        <a href="editShipAddress?id=<%=addrs[i]._id%>"><button >Edit</button></a>
                        <a href="#" class="removeAddress" data-address-id="<%= addrs[i]._id %>"><button >X</button></a>
                      </div>
                      <span>Name : </span>
                      <span style="color: #ffff;" class="mb-0"><%=addrs[i].fullName%></span> 
                    </div>
                    <div>
                      <span>Mobile : </span>
                      <span style="color: #ffff;" class="mb-0"><%=addrs[i].mobileNo%></span> 
                    </div>
                    <div>
                      <span>City : </span>
                      <span style="color: #ffff;" class="mb-0"><%=addrs[i].city%></span> 
                    </div>
                    <div>
                      <span>State : </span>
                      <span style="color: #ffff;" class="mb-0"><%=addrs[i].state%></span> 
                    </div>
                    <div>
                      <span>Country : </span>
                      <span style="color: #ffff;" class="mb-0"><%=addrs[i].country%></span> 
                    </div>
                    <div>
                      <span>Pincode : </span>
                      <span style="color: #ffff;" class="mb-0"><%=addrs[i].pincode%></span> 
                    </div>
                    
                  </div>
                </div>
              </div>
            </div>
          </div>
          <% } %>
          <% } %>
        </div>
      </div>
    </section>
    <script>
      $(document).ready(function() {
        $('.removeAddress').click(function(event) {
          event.preventDefault(); // Prevent default link behavior
    
          const addressId = $(this).data('address-id'); // Get the address ID from data attribute
          // AJAX call
          $.ajax({
            type: 'GET',
            url: '/removeAdr?id=' + addressId, // Your server endpoint
            success: function(response) {
              // Optionally, handle success response if needed
              // For example, update UI or notify the user
              console.log('Address removed successfully');
              // Reload the page after successful removal (optional)
              location.reload();
            },
            error: function(error) {
              // Handle error response if needed
              console.error('Error removing address:', error);
            }
          });
        });
      });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
